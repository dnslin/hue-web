# Lsky Pro 前端开发任务拆解与技术建议

## 功能模块

前端应用将包括以下主要功能模块，每个模块对应特定的页面或流程：



### 用户认证模块

- **功能范围：** 实现用户注册、登录及退出，并获取登录用户的个人信息。注册和登录表单需进行验证，支持错误提示。登录成功后保存认证令牌，维护用户会话状态。
- **移动端优化：** 登录/注册表单在移动端居中显示，使用较大且易于点击的输入框和按钮。输入框类型合理设置（如邮箱输入框使用 `type="email"` 以调起移动端邮箱键盘）。表单操作（提交、切换）提供手势支持，如点击空白处收起键盘等。

### 图片管理模块

- **功能范围：** 提供图片的上传、展示、管理功能。支持单张/多张上传，拖拽上传和剪贴板粘贴上传；显示图片列表（带分页、筛选、排序）；可查看图片详情（大图预览、图片信息）及执行图片删除、编辑名称/描述等操作（若后端支持编辑接口）。
- **移动端优化：** 图片列表使用响应式网格布局，保证不同屏幕宽度下每行显示适当数量的缩略图。移动端中提供优化的预览体验，例如支持手势滑动切换图片、双击或捏合放大缩小图片。确保图片缩略图在移动端按屏幕宽度自适应排列。

### 相册管理模块

- **功能范围：** 支持相册的创建、展示和维护。包括创建新相册，相册列表展示（显示相册封面、名称、图片数量等），相册详情页（显示该相册下所有图片），以及相册信息编辑和删除功能。
- **移动端优化：** 相册列表在移动端采用卡片式布局，每个相册块可方便点击。相册详情页的图片网格在小屏上自动调整列数或改为纵向列表，以便纵向滚动浏览。保证相册操作按钮（编辑、删除）在移动端易于点触。

### 分享模块

- **功能范围：** 实现图片或相册的一键分享功能。支持生成分享链接（POST `/shares` 创建包含图片或相册的分享令牌）；提供已创建分享链接的管理界面，列出用户生成的分享链接并支持删除；实现公开分享页面（依据分享令牌 GET `/shares/{token}` 获取内容并展示图片或相册）。
- **移动端优化：** 分享页面采用响应式设计，在移动设备上图片网格自动换行或改用列表样式。分享链接生成弹窗在移动端应以全屏对话框呈现，方便输入和操作。提供一键复制分享链接的按钮，点击后用 Toast 提示复制成功。

### 用户中心模块

- **功能范围：** 提供用户个人中心页面，可查看和修改个人资料信息（如用户名、邮箱，视后端 API 支持情况，通过例如 PUT `/users/{id}` 更新自身信息）。若支持 API Token 管理，则显示用户的 API Token 列表并提供创建/删除 Token 的功能。
- **移动端优化：** 个人资料表单在移动端排列为单列，输入框宽度通栏便于输入。确保修改操作的按钮在小屏幕上清晰可见。对于较长的内容（如 Token 列表）可使用折叠面板方式在移动端呈现，避免页面过长滚动。

### 设置模块

- **功能范围：** 显示站点配置信息（通过 GET `/settings` 获取，例如站点名称、最大上传大小等）。如果是管理员身份且后端支持设置修改（PUT `/settings`），则提供部分设置项的编辑功能。普通用户则仅能查看相关只读配置。
- **移动端优化：** 设置页面内容在小屏幕上以列表形式垂直排列，文字保持可读性。对于开关类配置项使用移动端友好的切换控件（如大号的 Switch），确保手指容易触及。若设置项较多，可考虑使用手风琴组件分组显示，减少单屏内容量。

### 管理后台模块

- **功能范围：** 提供管理员专属的一些数据查看页面，以辅助管理后台功能。包括用户列表查看（GET `/users` 列出所有用户）、存储策略列表查看（GET `/admin/storage-strategies` 查看配置的图床存储后端）。其他高级管理操作可能通过后端其他途径完成，前端主要提供只读浏览界面。
- **移动端优化：** 管理列表在移动端采用表格转卡片的展示方式——例如每个用户条目在小屏上显示为一个卡片，内部垂直列出用户名、邮箱等信息。对于宽度较大的表格（如存储策略列表），在移动端允许横向滚动查看完整内容。确保管理员页面在移动端依然可用，但更适合在桌面设备查看。

## 组件列表

前端将基于 Tailwind CSS 和 shadcn UI 构建一系列可复用的组件，方便快速搭建界面。组件分为以下几类：



- **基础 UI 组件：** 包括按钮、表单输入等最基础的元素，主要由 shadcn UI/Radix 提供样板并结合 Tailwind 定制样式。例如常用的有 `Button`、`Input`、`Select`、`Checkbox`、`RadioGroup`、`Switch`、`Dialog`、`DropdownMenu`、`Tooltip`、`Avatar`、`Badge`、`Card`、`Table`、`Tabs`、`Toast` 等组件。这些基础组件将统一样式风格，方便在全局复用。
- **布局组件：** 用于布局页面结构的复用组件。例如：
  - `MainLayout`：主布局组件，包含全局导航栏、（可能的侧边栏）和内容区域，用于包裹受保护的内部页面。
  - `AuthLayout`：认证页布局，用于登录、注册等页，使表单居中显示在屏幕中部。
  - `PageWrapper`：页面包装容器，为各页面提供统一的页眉（标题）区域、基本边距和响应式限定宽度等。
- **通用业务组件：** 封装业务特定功能且可在多个页面重复使用的组件，包括：
  - `ImageUploader`：图片上传组件，支持拖拽区域、文件选择按钮，以及选中图片的预览缩略和上传进度条。可复用于任何需要上传图片的场景（如主图片上传页或相册详情页）。
  - `ImageCard`：图片卡片组件，用于在列表或网格中展示单张图片缩略图及其名称、大小等信息，并附带操作按钮（如查看、分享、删除）。在图片列表页、相册详情页等多处使用，确保一致交互。
  - `ImageList`：图片列表容器组件，内部调用若干 `ImageCard` 来渲染图片网格。支持分页加载或无限滚动，以及筛选和排序控件，可在“我的图片”和“相册详情”等页面通用。
  - `AlbumForm`：相册表单组件，用于新建或编辑相册信息，包括相册名称、描述（以及可能的封面图选择）。通过属性控制是“新建”还是“编辑”模式。
  - `ShareDialog`：分享链接对话框组件，在用户请求分享图片或相册时弹出。负责输入分享参数（如有效期等，若有）、调用创建分享 API 并显示生成的分享链接。作为对话框组件，可在不同内容上下文（图片或相册）复用。
  - `UserProfileForm`：用户资料编辑表单组件，用于在个人中心修改用户名、邮箱、密码等。封装表单验证和提交逻辑。
  - **其他公共组件：** 如 `PageHeader`（页面头部，显示标题及操作按钮），`EmptyState`（空状态提示，在列表无内容时显示占位说明）等。这些组件提升一致性，例如所有列表页无内容时显示相同风格的空提示。

以上组件中，**基础UI组件**和**布局组件**会存放于通用的组件库中，供整个应用直接使用；**业务组件**则根据功能划分放在各模块或shared目录中，确保在不同页面之间可以方便复用。命名方面采纳 PascalCase 英文命名，直观表达组件用途，例如用 `ImageCard` 表示图片卡片组件、`AlbumForm` 表示相册表单组件，便于团队协作和代码可读性。



## 技术建议

为确保开发效率和代码质量，前端项目在技术选型和实践上需要注意以下几点：



- **框架与基础：** 使用 **Next.js 15.3.2** 作为前端框架，结合 **React 18+**。遵循 Next.js 的稳定特性，避免使用实验性功能（如 Server Actions、React 服务端组件 RSC、Edge Functions 等）以保证可预期的行为。充分利用 Next.js 提供的SSR/SSG能力提升性能和SEO，并使用内置的 `next/image` 对组件进行图片优化处理。
- **样式与设计体系：** 使用 **Tailwind CSS 4.1** 进行样式开发，高效利用原子类实现布局和间距等设计。制定统一的设计风格（简约个人化），通过自定义 `tailwind.config.js` 调整颜色和字体等主题变量。遵循原子化优先的原则构建样式，避免过度使用`@apply`以防止产出庞大CSS。充分利用 Tailwind 响应式断点类（`sm`, `md`, `lg` 等）实现多端适配。
- **UI 库与图标：** 基于 **shadcn UI** 组件体系构建界面。shadcn UI 提供了 Radix UI 为基础的无障碍组件，我们将通过其 CLI 或组件代码复制的方式，引入所需组件并定制样式。对于 UI 图标，采用 **lucide-react** 图标库（2025 年最新版本）以获得清晰简洁的 SVG 图标集。Icons 在组件中通过React组件直接引入，按需加载确保不增加太多打包体积。
- **状态管理：** 全局状态尽量精简，优先使用组件本地状态和通过 Props 传递数据。确需跨组件共享的状态（如当前用户信息、全局设置）可引入轻量级状态管理库如 **Zustand v5** 或 **Jotai v2** 来管理（它们在2025年均较为成熟稳定），以替代传统 Redux 实现更少样板代码。Zustand 提供简单的 API 创建全局 store，结合 TypeScript 类型方便维护；也可用 React Context 简单场景下传递状态。避免不必要的复杂全局状态，保持状态管理透明易懂。
- **表单与验证：** 推荐使用 **React Hook Form (RHF)** 最新版本（v7+）搭配 **Zod v4** 等模式验证库来处理表单数据和验证。RHF 能高效管理表单状态，减少重渲染，提高性能，而 Zod 提供 TypeScript 友好的模式定义和验证错误信息。所有重要表单（注册、登录、相册编辑、资料修改等）应定义清晰的校验规则（例如密码长度、邮箱格式等），在提交前即时提示用户错误。这样可以提升表单交互体验，避免不必要的提交失败。
- **数据请求与客户端封装：** 使用 **Axios (v1.x)** 库或 Next.js 内置的 `fetch` 封装统一的 HTTP 请求客户端。建议创建一个 `apiClient` 实例配置基础 URL、请求拦截器（附加认证 Token 等）和响应拦截器（统一错误处理）。在 `lib/api/` 目录下按资源分类封装 API 调用函数，例如 `imageService.ts` 中封装上传图片、获取图片列表等方法。这些封装应充分利用 **TypeScript** 定义请求和响应的数据类型（可根据 Swagger 定义自动生成或手动编写）以保证类型安全。统一的请求封装便于修改和维护，也方便在需要时切换实现（如从 Axios 改为 fetch）。
- **数据获取和缓存：** 前端推荐使用 **React Query (TanStack Query)** v5 或 Vercel 的 **SWR v2** 进行数据获取和客户端缓存管理。这类库提供声明式的 Hook 接口，支持请求数据缓存、错误重试、状态更新等功能，有助于简化数据请求流程。例如，使用 `useQuery` 获取图片列表数据，实现自动缓存和刷新；上传或删除图片后通过无效化缓存来刷新列表。这样可以减少直接操作全局状态的繁琐，在各种组件中更便利地获取数据。
- **错误处理与通知：** 实现统一的错误处理策略。在 Axios 响应拦截器或数据请求库中，全局处理常见错误码：如遇到 401 未授权错误，自动跳转到登录页；403 禁止访问错误，弹出提示说明无权限；500 系统错误，提示用户稍后重试。同时，利用 Toast 通知组件反馈操作结果，例如图片上传成功或失败、分享链接已复制等。shadcn UI 提供的 Toast 组件可用于全局状态通知，确保提示样式一致且不会被布局打断。
- **动画与交互效果：** 使用 **framer-motion**（Motion for React，2025 最新v12版）为组件和页面添加动画效果。关键交互加入轻量动画可提升用户体验，例如：上传图片后新图片列表项淡入呈现；打开对话框时使用渐入/缩放动画；侧边栏或菜单在移动端以滑动动画出现。Framer Motion 提供简单的 `motion` 组件和Hook，可用于实现拖拽排序、手势滑动等高级交互效果，如在移动端图片预览支持拖动关闭、相册图片切换动画等。注重动画流畅度，确保在低性能设备上也有良好表现。
- **响应式与跨端设计：** 按照“移动优先”原则设计界面，利用Tailwind的断点快速调整布局。桌面端可能有更复杂的布局（如侧边栏导航加内容区），而移动端应简化为单列视图或使用抽屉式导航。确保重要信息在小屏幕上不隐藏，必要时采用可滚动容器。对于表格等宽屏组件，小屏时可以：
  - 将表格转换为列表卡片布局，每条记录以卡片形式显示；
  - 或允许横向滚动表格，以查看超出屏幕的列。
    对于弹窗对话框，移动端下改为全屏显示或接近全屏，以获得更好的展示效果。
- **可访问性 (a11y)：** 重视无障碍设计，使用语义化的HTML元素（例如按钮使用 `<button>` 元素，表单控件搭配 `<label>`）。确保图像都有有意义的 `alt` 文本描述。交互组件（如对话框、菜单）遵循 WAI-ARIA 指引，提供正确的属性和焦点管理（Radix UI 组件本身已涵盖部分无障碍支持）。通过键盘操作测试主要功能，保证用户可以不依赖鼠标完成操作。

**依赖版本：** 所有引入的库应当使用截至 2025 年的最新稳定版本，以利用最新特性和修复。例如，Next.js 15.3.2、React 18.2+，Tailwind CSS 4.1，shadcn UI (基于 Radix UI 1.x)、lucide-react 最新版（约v0.5xx）、Framer Motion v12，React Hook Form v7.x、Zod v4，Axios v1.x，Zustand v5，TanStack React Query v5 等。选择成熟稳定的版本有助于减少潜在问题，并确保与现代浏览器和框架良好兼容。



## 开发任务清单

下面提供详细的开发任务清单，按模块划分具体的开发工作项，帮助逐步完成前端重构。执行时可按模块或页面循序进行，同时注意各部分之间的依赖关系。



### 项目初始化与全局架构

- **项目初始化：** 使用 Next.js 15 创建全新项目（`npx create-next-app@latest`），启用 TypeScript 支持。配置 Tailwind CSS 4.1（安装依赖并生成 `tailwind.config.js` 和全局样式文件，包含 Tailwind 指令）。
- **基础依赖安装：** 添加必要依赖库：shadcn UI（引入其 CLI 或按照文档复制组件代码），lucide-react 图标库，framer-motion 动画库，Axios 或其他请求库，React Hook Form 以及验证库（Zod/Yup），状态管理库（如 Zustand）等。确保这些库版本为最新稳定版并在 `package.json` 中正确声明。
- **全局样式与主题：** 设置 Tailwind 的全局样式（如在 `globals.css` 引入 `@tailwind base/components/utilities`），定制主题颜色和字体（根据项目需要在 `tailwind.config.js` 中配置）。设计一个简洁的配色方案，避免过度企业化风格，突出个人站点的清新简约。
- **shadcn UI 集成：** 使用 shadcn 提供的方式引入所需组件代码。在项目的 `components/ui` 目录下添加 Button、Input、Dialog、Toast 等基础组件，实现与设计风格一致的定制。验证这些组件运作正常，例如 Button 的各种状态（悬停、禁用）样式符合预期。
- **全局布局搭建：** 开发主布局 `MainLayout` 组件，包括站点头部导航栏和主内容容器（必要时加入侧边栏）。头部导航包含站点名称/Logo、主要导航链接（如“图片”、“相册”、“分享”、“个人中心”等）以及用户菜单（登录状态下显示用户名/头像及下拉退出按钮）。侧边栏（桌面端显示）列出应用各模块的菜单项；移动端隐藏侧边栏，采用汉堡菜单按钮+抽屉导航。实现响应式：在较大屏幕显示侧边栏，在小屏幕点击汉堡按钮时使用对话框/抽屉动画滑出菜单。
- **路由和页面结构：** 根据模块创建对应的页面路由文件：
  - 未登录用户可访问：注册页 (`/register`)、登录页 (`/login`)、公开分享页 (`/s/[token]`) 等；
  - 登录后访问：图片列表页 (`/images`)、相册列表页 (`/albums`)、分享管理页 (`/shares`)、个人中心页 (`/me`)、设置页 (`/settings`)、管理页 (`/admin/*`) 等。
    使用 Next.js 文件路由定义以上页面组件，配置好基本的导航链接。
- **AuthLayout 实现：** 为登录/注册等页创建单独的 `AuthLayout`，将页面内容居中显示。应用该布局于登录和注册页面组件，确保这些表单在各种屏幕上都在可见的中心位置。
- **API 客户端封装：** 在 `lib/api/` 目录下建立 API 客户端模块。例如创建 `apiClient.ts`，使用 Axios 创建实例，配置基础 URL（指向后端 API 的 `/api/v1` 前缀）和默认请求头（如 JSON、Auth Token）。编写拦截器处理响应错误，全局捕获401/403/500错误并抛出或调用通知。然后根据资源分类创建服务模块，如：
  - `authService.ts`：封装 `login(data) -> POST /auth/login`，`register(data) -> POST /auth/register`，`getCurrentUser -> GET /me` 等方法。
  - `imageService.ts`：封装 `uploadImage(formData) -> POST /images`，`getImages(params) -> GET /images`，`deleteImage(id) -> DELETE /images/{id}` 等。
  - `albumService.ts`：封装 `createAlbum -> POST /albums`，`updateAlbum -> PUT /albums/{id}`，`getAlbums -> GET /albums`，`getAlbumImages(id) -> GET /albums/{id}/images`，`deleteAlbum(id) -> DELETE /albums/{id}` 等。
  - `shareService.ts`：封装 `createShareLink(payload) -> POST /shares`，`deleteShare(token) -> DELETE /shares/{token}`，`getShareContent(token) -> GET /shares/{token}` 等。
  - 其他如 `userService.ts`（更新用户信息），`settingService.ts`，`adminService.ts` 等按需创建。以上方法返回 Axios Promise，可结合 React Query 使用。
- **状态管理设置：** 如果使用 Zustand 等库，创建全局 store。例如 `useAuthStore` 管理用户登录状态和信息：包含 token、当前用户对象，以及登录/退出动作（调用 authService 并更新状态）。确保在应用初始化时（如 `_app.tsx` 或布局组件）检查是否有有效登录（如从localStorage或cookie读取token，尝试获取用户信息），以决定初始跳转。对于主题偏好等也可放入全局状态。尽可能使用 TypeScript 定义 store 的状态和动作接口。

### 用户认证模块

- **注册页面开发：** 创建注册页组件 `/register`。构建注册表单，包含用户名、邮箱、密码、确认密码等字段。使用 React Hook Form 管理表单状态，结合 Zod/Yup 定义验证模式（用户名长度3-50，密码长度≥6等）。在输入不合法时实时显示错误消息。提交表单时调用 `authService.register()` 接口，成功则提示用户注册成功并引导至登录页，失败则根据错误码显示反馈（如邮箱已被占用等）。
- **登录页面开发：** 创建登录页组件 `/login`。包含邮箱/用户名和密码字段的登录表单。同样利用 RHF 管理输入和验证（确保必填）。提交时调用 `authService.login()`，成功后：
  - 将返回的 Token 保存（如通过 `useAuthStore` 存储并设置 Axios 默认Auth头），用户信息保存到全局状态；
  - 执行页面跳转（如重定向到图片列表首页 `/images`）。若登录失败（比如密码错误），在表单上方显示错误提示（考虑使用 Shake 动画增强提示效果）。
- **登录态维护：** 开发登录后状态保持逻辑。可选择使用浏览器的 `localStorage` 或 Cookies 存储JWT，以便刷新后仍能保持登录。若使用 Cookie（HttpOnly）方案，则需调整登录API使其在响应中设置Cookie。前端拿到 token 后，每次请求通过 Axios 拦截器附加在 Authorization 头上。实现“记住我”选项可决定 token 保存期限。
- **访问控制：** 在前端路由层面保护需要登录的页面。实现一个路由拦截机制：对于每个受保护页面组件，在`getServerSideProps`或页面初始化时检查是否存在有效登录状态，如无则重定向到登录页。或者在 `_app.tsx` 中监听路由变化，如将要进入内部页且未登录，则阻止并navigate到 `/login`。确保登录后再也不显示登录/注册页面（可重定向已登录用户访问 `/login` 到首页）。
- **退出登录：** 提供退出功能，例如在导航栏用户菜单中加入“退出”按钮。点击触发时，清除存储的 token 和用户数据（清空 Zustand store 或Cookie），并重定向到登录页。调用 `authService.logout()` 接口（若后端需要使 token 失效，可能调用 DELETE /auth/logout，如无则仅前端清除即可）。
- **移动端适配：** 确认登录/注册页在小屏幕上的展示效果：使用 AuthLayout 保持表单居中，表单容器左右留有间距避免贴边。表单Scrolling在虚拟键盘弹出时可见。优化键盘交互，例如输入完密码点“下一步”直接提交表单。所有触发提交的按钮宽度适应屏幕且有足够触摸高度。

### 图片管理模块

- **图片上传功能：** 开发 `ImageUploader` 组件，可在主图片页或相册页中使用。实现文件选择和拖拽上传：
  - 使用原生文件输入 (`<input type="file" multiple>`) 结合 `onChange` 获取文件列表，并支持将组件容器设为拖放区域 (`DragEvent`)，在 `onDrop` 时获取文件。
  - 显示选中图片的预览缩略图列表（使用 File API 创建本地URL或小图加载），以及文件名、大小信息。对不符合条件的文件（类型或大小超限）给予提示。
  - 点击上传按钮或确认后，遍历文件列表调用 `imageService.uploadImage()` 接口（POST `/images`，支持批量时可并行发送或一次传多个文件）。上传过程中显示进度条或百分比。上传成功后，将新图片数据添加到图片列表状态，并清空选中文件；失败则标记对应文件项错误。
  - 支持剪贴板粘贴上传：监听 `paste` 事件，如果 `clipboardData` 包含图像文件，则触发与选择文件相同的流程，方便用户直接粘贴截图上传。
  - 界面交互细节：拖拽过程高亮显示目标区域（使用 Tailwind 类如 `border-dashed border-2 border-blue-500` 等给予视觉反馈）；上传过程中禁止重复提交（按钮 loading 状态）。
- **图片列表页开发：** 创建图片列表页面组件 `/images`，用于展示当前用户所有上传的图片库。
  - **数据获取：** 页面加载时通过 React Query 或 SSR 调用 `imageService.getImages({ page, page_size, ... })` 获取图片列表数据。实现分页加载，可采用分页器（上一页/下一页按钮）或“加载更多”按钮。如果API提供筛选参数（如按相册、按关键字），提供相应筛选控件（下拉选择相册筛选、搜索框按文件名筛选等）。
  - **布局呈现：** 使用 `ImageList` 组件以网格形式渲染图片缩略。每个图片使用 `ImageCard` 展示缩略图（用 Next.js 的 `Image` 组件加载优化过的缩略图）、文件名或标题，以及交互按钮（查看详情、复制链接、分享、删除等）。在大屏幕每行显示多列缩略图，小屏幕下自动调整为1-2列以适应屏宽。
  - **操作交互：** 实现每张图片的操作：点击缩略图或“查看”按钮，打开图片详情（见下条）；点击“分享”触发 `ShareDialog` 弹出并生成分享链接；点击“复制链接”将图片直链复制到剪贴板（并用 Toast 提示）；点击“删除”则弹出确认对话框，确认后调用 `imageService.deleteImage(id)` 删除。删除成功后从当前列表移除该图片项，并用 Toast 通知已删除。
  - **空列表状态：** 当用户还没有上传任何图片时，显示 `EmptyState` 提示（如“暂无图片，点击上传”），并提供上传按钮的快捷入口。
  - **性能与优化：** 缩略图使用 Next/Image 自动适配大小和格式，提高加载速度。列表采用虚拟滚动或懒加载（如使用 `loading="lazy"`）处理大量图片时的性能。对删除、上传等操作利用React Query的缓存更新即时反映，无需全量刷新列表。
- **图片详情查看：** 开发图片详情页面或组件，用于显示单张图片的大尺寸预览和详细信息。
  - 路由设计为 `/images/[id]`（独立页面）或通过状态管理控制一个详情对话框/侧栏。在详情视图中，使用高分辨率的 `next/image` 显示图片大图。展示图片的元数据：文件名、分辨率（宽x高）、大小、上传时间等；如果有描述说明也一并展示。
  - 提供对该图片的操作：如编辑按钮（若支持修改名称/描述则点击切换成可编辑表单，提交时调用 PUT `/images/{id}` 更新后端）、删除按钮（功能同列表页删除，但在详情页操作后需要导航回列表或关闭详情框）。
  - 如果图片属于某相册，显示相册名称并可导航进入相册；若没有相册可提供“移动到相册”操作（下拉选择相册后调用相应API更新图片的 albumID）。
  - **导航UX：** 若以页面形式呈现详情，提供返回按钮回到图片列表；如果是对话框形式，点空白或关闭按钮即可回到列表视图。
  - **移动端体验：** 大图预览在移动端允许用户手势放大缩小。可借助浏览器默认行为或引入轻量库实现双指缩放与拖动查看。确保详情页在小屏下无溢出，必要时信息区域可纵向滚动。关闭详情使用清晰的“关闭”图标按钮，方便触摸。
- **批量操作（可选）：** 如果需求包括批量删除或下载等，可在列表页加入多选模式。实现方式：列表项支持复选选中，顶部出现批量操作栏（删除所选、下载所选等）。此为扩展功能，可视时间和需求决定实现。
- **与相册集成：** 确保图片上传时可以指定相册（例如在 ImageUploader 提供选择所属相册的下拉菜单，特别是在相册详情页调用Uploader时默认选定该相册ID）。图片列表页可通过筛选只看某相册的图片，或者通过 URL 参数实现（如 `/images?album=ID`）。
- **动画和细节：** 列表图片在加载和更新时加入动画效果。比如新上传的图片以淡入效果插入列表；删除图片时让卡片缩退消失。悬停在图片卡片上显示操作按钮区域（移动端则始终显示或用长按唤出菜单）。使用 framer-motion 简洁地实现这些过渡效果，增加页面的动感但不喧宾夺主。

### 相册管理模块

- **相册列表页开发：** 创建相册列表页面组件 `/albums`，展示当前用户创建的所有相册。
  - **数据获取：** 页面初始化时调用 `albumService.getAlbums()` 获取相册列表数据。若数据量较大，可分页加载相册列表或采用懒加载。相册数据包含名称、描述、创建日期、封面图（如果有）等。
  - **布局呈现：** 使用卡片列表布局，每个相册渲染为一个 `Card`。卡片内容包括相册封面（如有封面图则显示图片缩略图，否则显示默认相册图标）、相册名称、图片数量和可能的相册描述摘要。卡片整个区域可点击进入相册详情。
  - **相册操作：** 在列表页提供“新建相册”按钮，点击后弹出 `AlbumForm` 对话框用于输入相册名称和描述。提交表单调用 `albumService.createAlbum()` 创建相册。成功后关闭对话框并将新相册插入列表顶部，并弹出提示“相册创建成功”。相册卡片上提供菜单按钮（省略号）触发下拉菜单，可选择“编辑”或“删除”：编辑操作亦使用 `AlbumForm` 弹出，初始化表单为当前相册信息，提交调用 `albumService.updateAlbum(id)` 更新相册；删除操作弹出确认对话框，确认后调用 `albumService.deleteAlbum(id)` 删相册，成功后从列表移除该卡片并提示。
  - **移动端适配：** 相册卡片在小屏幕上采用一列或两列瀑布流布局，每个卡片宽度100%或50%。卡片内元素（封面图、文本）垂直堆叠以充分利用窄屏空间。点击卡片即可进入，无需悬停交互。在移动端新建/编辑相册对话框改为全屏呈现，表单项垂直排列方便输入。
- **相册详情页开发：** 创建相册详情页面组件 `/albums/[id]`，用于查看单个相册的内容。
  - **顶部信息：** 在页面顶部显示相册的名称和描述、创建时间等信息。提供相册操作按钮，例如“编辑相册信息”（调用同样的 `AlbumForm`）、“删除相册”（调用删除流程后返回相册列表）。
  - **图片列表：** 下方使用之前的 `ImageList` 组件显示该相册包含的所有图片。获取数据时调用 `albumService.getAlbumImages(id)` 或通用的 `imageService.getImages({ album_id: id })` 获取此相册下图片。支持分页加载若图片很多。布局和操作与主图片列表一致（复用 ImageCard），但这里只显示属于该相册的图片。
  - **上传到相册：** 在相册详情页集成 `ImageUploader` 组件，允许用户直接在当前相册中上传新图片。Uploader 调用上传 API 时附带相册ID参数，使上传的图片归属当前相册。新图片上传成功后即刻插入当前列表。
  - **移动端适配：** 相册详情页结构在移动端依然是上下排列的信息->图片列表。若相册描述较长，可以收叠或只显示前几行点“更多”展开。确保返回相册列表的导航明显可见（例如顶栏返回箭头）。图片网格在移动端按屏幕宽度自动调整列数，参考图片管理模块的响应式实现。
  - **动画效果：** 进入相册详情页时，可以使用视觉过渡（如封面图放大展开效果）增强调性。图片列表加载和更新时保持与主图片列表一致的动画逻辑。编辑相册信息的对话框在打开关闭时使用淡入淡出过渡。
- **相册权限（如适用）：** 如果后端支持相册公开/私有设置（Swagger定义中有 isPublic 字段），则在相册创建/编辑表单中增加开关控制相册公开性。公开相册可能允许未登录用户查看（通过分享模块或公开页面），这里前端尊重此设置显示相应标识（比如相册列表里标注“公开”状态）。
- **错误处理：** 处理相册操作中的各种错误情况，如创建相册时重名错误、删除相册时后端返回非空不能删等，予以友好提示。尽量在前端验证避免常见错误（例如相册名称不能为空）。

### 分享模块

- **分享链接生成：** 在图片列表或相册详情界面，用户点击“分享”操作时，打开 `ShareDialog` 对话框。对话框内容：
  - 让用户确认将生成分享链接（若需要可选择分享有效期等参数，参考 Swagger 定义 expire_days）。简单起见，如果没有其他选项，就直接显示一个生成中的状态。
  - 调用 `shareService.createShareLink({ resource_id, type })`，根据当前分享对象是图片或相册传入对应ID和类型。等待API响应，成功后获取到分享 token（如响应包含 token 或完整URL）。
  - 在对话框中显示生成的分享链接 URL（组合站点前缀和 token）。提供复制按钮，一键复制链接到剪贴板，并提示“已复制”。如果支持有效期，在UI上也显示过期时间。
  - 处理错误：若生成失败（例如用户无权分享该资源），提示失败原因并允许重试或取消。
- **分享链接管理页：** 开发分享管理页面组件 `/shares`（登录用户专用）。功能：
  - 调用可能存在的 API（如 GET `/shares` 列出当前用户创建的所有分享链接）获取分享列表。如果没有统一列出接口，则在每次创建后将结果存入全局状态，并在此页面读取该状态显示。
  - 列表展示每个分享条目：包含分享对象名称（例如图片文件名或相册名）、分享类型、创建时间、分享URL（或 token）等。提供“复制链接”和“取消分享”两个操作按钮。
  - 点击“复制链接”同前，在后台调用 `navigator.clipboard.writeText()` 实现并 Toast 通知。点击“取消分享”则调用 `shareService.deleteShare(token)` 删除该分享。删除后立即从列表移除该条目，并提示“链接已取消/失效”。
  - 若没有分享记录，使用 `EmptyState` 提示“暂无分享链接”。
  - 列表UI上可使用 `Table` 表格组件在桌面显示为多列（名称/类型/日期/操作），移动端切换为卡片列表显示每条分享的信息。
- **公开分享页面：** 开发动态路由页面 `/s/[token]`，用于任何用户通过分享链接访问内容。
  - 在 `getServerSideProps` 或页面加载时，根据URL中的 token 调用 `shareService.getShareContent(token)` (GET `/shares/{token}`) 获取分享内容详情。根据返回数据的类型展示：如果是图片分享，直接显示单张图片预览；如果是相册分享，显示该相册下所有图片的画廊。
  - **图片分享页面：** 渲染一个居中的图片大图（使用 next/image 适配尺寸），下方显示图片标题或文件名，以及上传者或站点名称。提供下载按钮（直接链接原图地址）和站点导航链接（例如“前往本站查看更多”）。
  - **相册分享页面：** 显示相册名称和描述，然后是图片网格列表（可复用 ImageList，但禁用管理操作）。用户可以点击缩略图预览大图（实现简易画廊功能，可用 framer-motion 或开源 lightbox 组件来切换查看）。
  - 对于无效或过期的 token，页面应显示友好的错误信息（如“分享链接不存在或已失效”），并提供返回首页的导航按钮。
  - **样式与导航：** 公开分享页应使用简化布局，不显示用户私人导航元素。可以在顶部显示站点Logo和一个返回主站链接。整体风格与主站一致但更专注内容本身。
  - **SEO 考虑：** 对公开分享的相册页，可以在页面 `<head>` 中注入相册名称、描述等 meta 标签，提升社交平台分享时的表现。由于内容可能希望被索引，可考虑允许爬虫抓取公开相册页面（Next SSR 默认即可被索引）。
  - **响应式：** 确保分享页在移动端有良好体验。图片自动适应屏幕宽度显示；多个图片的相册用单列列表或小缩略图网格。提供手势支持：如在移动设备上滑动切换图片预览。
- **安全与限制：** 如果分享链接可以设置密码或有效期（Swagger提到 expire_days 可选），前端需要支持：生成链接时提供输入有效期天数；打开分享页时若返回指示需要密码，则弹出密码输入框，再提交验证获取内容。由于问题未强调，此处按简单公开链接处理。
- **用户提示：** 当用户创建分享链接后，可提示“请将此链接分享给他人，未持有链接的人无法访问”。在分享管理页，清楚标识哪些分享是相册、哪些是单张图片，以免混淆。

### 用户中心模块

- **个人资料页面：** 开发个人中心页面组件 `/me`，用于展示和修改用户信息。
  - **信息展示：** 页面初始化时调用 `authService.getCurrentUser()`（GET `/me`）获取用户详情。展示基本信息如用户名、邮箱、注册日期、头像（如果有头像URL）。界面上可放置头像的 `Avatar` 组件和文字信息。
  - **信息编辑：** 在个人信息区放置“编辑资料”按钮，点击进入编辑模式：可跳转到 `/me/edit` 页面或直接在当前页面切换表单。使用 `UserProfileForm` 组件展示可编辑的表单字段（用户名、邮箱等）。如允许修改密码，可在此提供修改密码链接（跳转到单独的修改密码表单页面）。
  - **提交更新：** 表单验证输入有效后，调用 `userService.updateUser(id, data)`（对于当前用户的更新，可能是 PUT `/users/{id}`）提交修改。成功后更新全局用户状态，刷新显示并提示“资料已更新”。若后端要求重新登录验证（比如更改敏感信息），根据返回处理。
  - **修改密码：** 如果提供修改密码功能，单独提供一个子页面或对话框。要求用户输入当前密码、新密码并确认新密码，验证通过后调用相应API（可能是 PUT `/users/{id}/password` 之类）修改。成功后提示并引导用户重新登录（如果令牌失效）。
  - **API Token 管理：** 若后端开放 API Token 功能，增加“API Tokens”板块。展示已有 Token 列表（可能只显示 token 名称及前几位以示区别，出于安全完整 token 不直接显示）。提供“新建 Token”按钮，点击弹出对话框要求输入用途描述/备注，调用相应API（POST `/tokens`）生成。成功后展示新 Token 值并提示复制保存；之后刷新列表。每个 token 列表项提供“删除”按钮，调用 DELETE `/tokens/{id}` 撤销。
  - **移动端适配：** 个人中心在移动端布局为单列，可使用 Tabs 组件分隔不同子模块（资料编辑、Token 列表等）以避免长页面滚动。头像等图片在小屏上适当缩小。表单控件占满宽度，留足内边距防止贴边。
  - **验证与安全：** 在更新敏感信息时进行必要确认，比如更改邮箱需要提供密码确认。所有表单交互需及时反馈错误，如邮箱格式不正确、用户名重复等。前端不存储明文密码，调用修改密码API时做好字段命名和加密（如需要在前端哈希则按后端要求，否则通过HTTPS保障安全）。

### 设置模块

- **站点设置页面：** 开发设置页组件 `/settings`，用于展示站点的公共配置信息。
  - **数据展示：** 页面加载时调用 `settingService.getSettings()` (GET `/settings`) 获取设置数据。将重要的配置项以列表形式展示，例如：站点名称、允许注册与否、默认存储策略、最大上传文件大小、图床版本号等。普通用户只读查看。
  - **管理员编辑：** 如果当前用户有管理员权限且后端支持更改设置（PUT `/settings`），则在对应项右侧显示“编辑”或开关控件。实现可编辑的设置如：“开启用户注册”（布尔值，用 Switch 切换）、“站点名称”（文本框）等。用户修改后点击保存，调用 `settingService.updateSettings(changes)` 提交。成功后更新UI并toast提示“设置已保存”；若失败（权限不足或验证失败）则提示错误。
  - **界面布局：** 设置项较多时可分组显示，比如基本设置、上传设置等，用 `<h4>` 小标题区分。每项采用两栏布局：左侧是设置名称及说明，右侧是设置值或编辑控件。移动端下改为单栏堆叠，名称和值上下排列。
  - **即时生效：** 修改部分前端相关设置（如站点名称或主题）后，前端应用应即时响应。例如站点名称改变后，导航栏处的名称要同步更新。这需要通过全局状态或重新获取设置后刷新相应组件来实现。
  - **权限控制：** 确保非管理员用户进入此页时只能看到允许的公开配置且不可编辑。可在获取设置后根据用户角色动态决定是否渲染编辑控件，或者在进入页面前就验证权限不足则重定向走。

### 管理后台模块

- **用户列表页：** 开发管理员查看用户列表的页面组件 `/admin/users`。
  - **数据获取：** 管理员进入该页时调用 `adminService.getUsers()` (GET `/users` 列出所有用户) 获取用户数据列表。数据包括用户ID、用户名、邮箱、注册日期、状态/角色等。
  - **列表呈现：** 桌面端使用表格 (`Table` 组件) 展示，多列分别为用户ID、用户名、邮箱、注册日期、角色、操作等。对于操作，如果允许管理员管理用户，可提供诸如“禁用/启用”或“提升权限”等按钮；若无管理功能，则只读显示。在移动端，将每个用户条目渲染为卡片形式：重要信息（用户名、邮箱）明显显示，其他信息小号展示，操作按钮在卡片底部排布。
  - **筛选搜索：** 如果用户数量很多，可在顶部提供搜索框按用户名/邮箱过滤，或下拉按角色筛选。输入搜索后调用过滤API（若有）或在前端列表中过滤。
  - **分页处理：** 若用户数非常多，实现分页或无限滚动加载。可以在 API 请求中使用分页参数（如 `page` 和 `page_size`）。
  - **操作功能：** 假如后端提供用户管理接口，可实现：点击“禁用”按钮调用相应API更改用户状态，完成后更新该行状态显示；点击“删除用户”调用 DELETE `/users/{id}` 删除用户（需要二次确认）。**注意**：执行敏感操作前需二次确认，避免误操作。
- **存储策略列表页：** 开发管理员查看存储策略的页面组件 `/admin/storage-strategies`。
  - **数据获取：** 进入页面时调用 `adminService.getStorageStrategies()` (GET `/admin/storage-strategies`) 获取存储策略列表数据。数据包括每个存储策略的ID、名称、类型（如本地、S3、OSS等）、当前状态（启用/禁用）、是否默认等信息。
  - **展示布局：** 列表使用表格或卡片形式：例如每个存储策略一张卡片，列出名称、类型、bucket信息等。如果字段较多，桌面端可用表格展示字段，移动端转为卡片。对默认策略或启用状态加以标识（例如徽章Badge表示“默认”）。
  - **操作功能：** 根据后端能力，可能允许管理员切换默认存储策略或编辑策略配置。如果有，则提供“设为默认”按钮（调用PUT接口切换默认），或“编辑”按钮（跳转到编辑表单页面）。若无修改接口，则仅展示配置。在列表中可以提供“查看详情”链接跳转到策略详情页（如果规划的话）。
- **日志/其他管理（可选）：** 如果扩展需求，包括查看操作日志、系统信息等，可在 `/admin` 下增设相应页面。这些类似只读表格或文本展示，不在本清单主要范围内，可根据实际增加。
- **权限和导航：** 管理页应仅管理员角色可见。前端在渲染导航菜单时，根据当前用户角色决定是否显示“管理后台”板块。路由层面也应保护，比如普通用户强行访问 `/admin/...` 时，前端重定向或显示403提示。
- **移动端注意：** 管理后台主要面向桌面，但仍确保基本可用。对于复杂的表格，在移动端以左右滑动容器方式呈现，或使用 `<details>` 元素折叠次要信息，仅展示主要字段。另外，管理操作按钮在移动端操作需更加慎重，提供足够大的点按区域和明确的操作反馈。

### 全局功能与其他任务

- **导航和菜单：** 完善导航栏和菜单交互。实现当前激活路由的高亮显示。对于移动端，完成汉堡菜单的交互：点击时使用 framer-motion 将抽屉导航从屏幕侧滑出，提供菜单列表，点击菜单项或遮罩区关闭抽屉。确保导航栏在不同页面复用且根据登录状态显示不同选项（未登录时显示登录/注册按钮，已登录显示用户名/退出）。
- **全局反馈组件：** 利用 shadcn UI 的 `<Toast>` 系统，实现全局消息提示机制。设置一个 Toast Provider 在应用根部，使得各处操作可以调起通知。例如上传成功/失败、保存设置成功、错误异常等都通过 toast 弹出提示。定制 toast 样式与主题一致，并考虑在移动端的位置（可放底部居中避免遮挡内容）。
- **Loading 状态处理：** 为数据加载过程提供友好的反馈。引入加载指示器组件，如全局页面切换时在顶端显示进度条（可使用 NProgress 库或自定义一个顶栏 loading bar）。对于局部区域加载，使用 Skeleton 骨架屏组件或 Spinner：例如图片列表初始加载时显示一组图片卡片骨架，表单提交中按钮上显示加载动画等。shadcn UI 提供的 Skeleton 组件可以快速实现占位效果。
- **错误边界：** 实现React错误边界组件，捕获渲染中的未处理异常，显示错误UI，防止白屏。可以创建一个 ErrorBoundary 类组件包裹主布局，发生错误时展示提示信息并提供重载页面选项。
- **性能优化：** 开启 Next.js 的性能优化选项：使用动态导入 (`next/dynamic`) 分割较大组件（如图像预览组件、富文本编辑器等）以按需加载；配置 `next.config.mjs` 启用SWC编译优化和压缩。检查 Lighthouse 性能指标，优化不必要的重渲染和大图加载。使用浏览器缓存策略（HTTP头）与 React Query 缓存配合，加快重复访问的响应。
- **测试与验证：** 在开发过程中，为关键功能编写测试用例。使用 React Testing Library 做组件单元测试，例如表单验证逻辑、组件渲染正确性；使用 Cypress 等进行端到端测试模拟用户上传图片、分享链接的完整流程，确保各模块协同工作正确。手动在不同浏览器和设备上测试响应式布局和交互，确保没有明显样式问题或功能缺陷。对照 Swagger 文档逐一验证 API 集成的正确性，特别关注边界条件（如上传超大文件、分享无权限资源等）的处理。
- **部署准备：** 配置生产构建优化，如使用 `next build` 生成优化后的产物。确保环境变量（如后端 API URL）在打包时正确注入。进行代码审查和性能审计，清理调试代码。准备将应用部署到托管平台或服务器，并进行上线前最终验证。

以上任务清单涵盖了 Lsky Pro 前端重构的主要开发工作。按照模块划分任务有助于逐步完成系统各功能点。开发中应始终注意组件复用、代码风格一致和用户体验优化，并结合动画和响应式设计细节，让最终产品既功能完善又具有现代化的交互体验。